<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Transaction History - Bank of America</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* Bank of America Style - Exact Match */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }

    :root {
      --boa-red: #E31837;
      --boa-dark-blue: #12326B;
      --boa-white: #ffffff;
      --boa-light-gray: #f5f7fa;
      --boa-gray: #767676;
      --boa-dark-gray: #333333;
      --boa-border: #e5e5e5;
      --boa-background: #f3f3f3;
    }

    body {
      background-color: var(--boa-white);
      margin: 0;
      padding: 0;
      color: var(--boa-dark-gray);
    }

    .mobile-container {
      max-width: 414px;
      margin: 0 auto;
      background-color: var(--boa-white);
      position: relative;
      min-height: 100vh;
    }

    /* Header */
    .boa-header {
      background-color: var(--boa-white);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px;
      border-bottom: 1px solid var(--boa-border);
    }

    .logo {
      display: flex;
      align-items: center;
    }

    .logo-text {
      font-size: 18px;
      font-weight: bold;
      color: var(--boa-dark-blue);
    }

    .logo-icon {
      margin-left: 5px;
      color: var(--boa-red);
      font-size: 20px;
    }

    .profile-icon {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      background-color: #f0f0f0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--boa-dark-gray);
      font-size: 20px;
    }

    /* Transactions Banner */
    .transactions-banner {
      background-color: var(--boa-red);
      padding: 20px 15px;
      color: var(--boa-white);
    }

    .banner-title {
      font-size: 24px;
      font-weight: normal;
      margin-bottom: 5px;
    }

    .banner-subtitle {
      font-size: 16px;
      margin-bottom: 20px;
    }

    /* Transactions Content */
    .transactions-content {
      padding: 20px 15px;
    }

    .filter-section {
      margin-bottom: 20px;
    }

    .filter-label {
      font-weight: bold;
      margin-bottom: 10px;
      display: block;
    }

    .filter-select {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid var(--boa-border);
      border-radius: 5px;
      font-size: 16px;
      background-color: var(--boa-white);
      appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23767676' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 15px center;
      background-size: 15px;
    }

    .transactions-list {
      border: 1px solid var(--boa-border);
      border-radius: 10px;
      overflow: hidden;
    }

    .transaction-item {
      padding: 15px;
      border-bottom: 1px solid var(--boa-border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .transaction-item:last-child {
      border-bottom: none;
    }

    .transaction-details {
      flex: 1;
    }

    .transaction-title {
      font-weight: bold;
      margin-bottom: 5px;
    }

    .transaction-date {
      font-size: 14px;
      color: var(--boa-gray);
    }

    .transaction-amount {
      font-weight: bold;
    }

    .transaction-amount.credit {
      color: green;
    }

    .transaction-amount.debit {
      color: var(--boa-red);
    }

    .no-transactions {
      padding: 20px;
      text-align: center;
      color: var(--boa-gray);
    }

    /* Bottom Navigation */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      max-width: 414px;
      margin: 0 auto;
      height: 60px;
      background-color: var(--boa-white);
      display: flex;
      justify-content: space-around;
      align-items: center;
      border-top: 1px solid var(--boa-border);
      z-index: 100;
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 8px 0;
      width: 25%;
    }

    .nav-item.active {
      color: var(--boa-red);
    }

    .nav-item i {
      font-size: 20px;
      margin-bottom: 4px;
    }

    .nav-text {
      font-size: 12px;
    }

    /* Content padding for bottom nav */
    .boa-content {
      padding-bottom: 80px;
    }
  </style>
</head>
<body>
  <div class="mobile-container">
    <!-- Header -->
    <header class="boa-header">
      <div class="logo">
        <div class="logo-text">BANK OF America</div>
        <div class="logo-icon">
          <i class="fas fa-flag"></i>
        </div>
      </div>
      <div class="profile-icon" id="profile-btn">
        <i class="fas fa-user"></i>
      </div>
    </header>

    <!-- Main Content -->
    <main class="boa-content">
      <!-- Transactions Banner -->
      <section class="transactions-banner">
        <div class="banner-title">Transaction History</div>
        <div class="banner-subtitle">View all your account transactions</div>
      </section>

      <!-- Transactions Content -->
      <section class="transactions-content">
        <div class="filter-section">
          <label class="filter-label">Filter Transactions</label>
          <select class="filter-select" id="transaction-filter">
            <option value="all">All Transactions</option>
            <option value="credit">Money Received</option>
            <option value="debit">Money Sent</option>
          </select>
        </div>
        
        <div class="transactions-list" id="transactions-list">
          <div class="no-transactions" id="no-transactions">
            No transactions found
          </div>
          <!-- Transactions will be loaded here -->
        </div>
      </section>
    </main>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
      <div class="nav-item" id="nav-accounts">
        <i class="fas fa-credit-card"></i>
        <div class="nav-text">Accounts</div>
      </div>
      <div class="nav-item active" id="nav-pay">
        <i class="fas fa-exchange-alt"></i>
        <div class="nav-text">Pay & Transfer</div>
      </div>
      <div class="nav-item" id="nav-plan">
        <i class="fas fa-chart-line"></i>
        <div class="nav-text">Plan & Track</div>
      </div>
      <div class="nav-item" id="nav-investment">
        <i class="fas fa-chart-bar"></i>
        <div class="nav-text">Investment</div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // Check if user is logged in
      const isLoggedIn = localStorage.getItem("isLoggedIn") === "true";
      if (!isLoggedIn) {
        window.location.href = "login.html";
        return;
      }

      // Get user data from localStorage
      const userString = localStorage.getItem("user");
      let user = null;

      if (userString) {
        try {
          user = JSON.parse(userString);
        } catch (e) {
          console.error("Error parsing user data:", e);
        }
      }

      // Handle profile button click
      const profileBtn = document.getElementById("profile-btn");
      if (profileBtn) {
        profileBtn.addEventListener("click", () => {
          window.location.href = "dashboard.html";
        });
      }

      // Handle bottom navigation
      const navAccounts = document.getElementById("nav-accounts");
      const navPay = document.getElementById("nav-pay");
      
      if (navAccounts) {
        navAccounts.addEventListener("click", () => {
          window.location.href = "dashboard.html";
        });
      }
      
      if (navPay) {
        navPay.addEventListener("click", () => {
          window.location.href = "send-money.html";
        });
      }

      // Load transactions
      loadTransactions();

      // Handle filter change
      const transactionFilter = document.getElementById("transaction-filter");
      if (transactionFilter) {
        transactionFilter.addEventListener("change", () => {
          loadTransactions(transactionFilter.value);
        });
      }
    });

    // Function to load transactions
    function loadTransactions(filter = "all") {
      const transactionsList = document.getElementById("transactions-list");
      const noTransactionsElement = document.getElementById("no-transactions");
      
      if (!transactionsList) return;
      
      // Get user data
      const userString = localStorage.getItem("user");
      if (!userString) return;
      
      const user = JSON.parse(userString);
      
      // Get transactions from localStorage
      const transactionsString = localStorage.getItem("transactions");
      let transactions = [];
      
      if (transactionsString) {
        try {
          transactions = JSON.parse(transactionsString);
          
          // Filter transactions for current user
          let userTransactions = transactions.filter(t => 
            t.senderAccountNumber === user.accountNumber || 
            t.recipientAccountNumber === user.accountNumber
          );
          
          // Apply filter
          if (filter === "credit") {
            userTransactions = userTransactions.filter(t => 
              t.recipientAccountNumber === user.accountNumber
            );
          } else if (filter === "debit") {
            userTransactions = userTransactions.filter(t => 
              t.senderAccountNumber === user.accountNumber
            );
          }
          
          // Sort by date (newest first)
          userTransactions.sort((a, b) => new Date(b.date) - new Date(a.date));
          
          if (userTransactions.length > 0) {
            // Hide no transactions message
            if (noTransactionsElement) {
              noTransactionsElement.style.display = "none";
            }
            
            // Clear existing transactions
            transactionsList.innerHTML = "";
            
            // Add transactions to the list
            userTransactions.forEach(transaction => {
              const isCredit = transaction.recipientAccountNumber === user.accountNumber;
              const transactionItem = document.createElement("div");
              transactionItem.className = "transaction-item";
              
              const formattedDate = new Date(transaction.date).toLocaleDateString();
              const formattedAmount = "$" + transaction.amount.toLocaleString(undefined, {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
              });
              
              transactionItem.innerHTML = `
                <div class="transaction-details">
                  <div class="transaction-title">${isCredit ? 'Received from' : 'Sent to'} ${isCredit ? transaction.senderName || 'Unknown' : transaction.recipientName || 'Unknown'}</div>
                  <div class="transaction-date">${formattedDate}</div>
                </div>
                <div class="transaction-amount ${isCredit ? 'credit' : 'debit'}">
                  ${isCredit ? '+' : '-'}${formattedAmount}
                </div>
              `;
              
              transactionsList.appendChild(transactionItem);
            });
          } else {
            // Show no transactions message
            if (noTransactionsElement) {
              noTransactionsElement.style.display = "block";
            }
          }
        } catch (e) {
          console.error("Error parsing transactions:", e);
        }
      }
    }
  </script>
</body>
</html>