<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Send Money - Bank of America</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* Bank of America Style - Exact Match */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }

    :root {
      --boa-red: #E31837;
      --boa-dark-blue: #12326B;
      --boa-white: #ffffff;
      --boa-light-gray: #f5f7fa;
      --boa-gray: #767676;
      --boa-dark-gray: #333333;
      --boa-border: #e5e5e5;
      --boa-background: #f3f3f3;
    }

    body {
      background-color: var(--boa-white);
      margin: 0;
      padding: 0;
      color: var(--boa-dark-gray);
    }

    .mobile-container {
      max-width: 414px;
      margin: 0 auto;
      background-color: var(--boa-white);
      position: relative;
      min-height: 100vh;
    }

    /* Header */
    .boa-header {
      background-color: var(--boa-white);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px;
      border-bottom: 1px solid var(--boa-border);
    }

    .logo {
      display: flex;
      align-items: center;
    }

    .logo-text {
      font-size: 18px;
      font-weight: bold;
      color: var(--boa-dark-blue);
    }

    .logo-icon {
      margin-left: 5px;
      color: var(--boa-red);
      font-size: 20px;
    }

    .profile-icon {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      background-color: #f0f0f0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--boa-dark-gray);
      font-size: 20px;
      cursor: pointer;
    }

    /* Send Money Banner */
    .send-money-banner {
      background-color: var(--boa-red);
      padding: 20px 15px;
      color: var(--boa-white);
    }

    .banner-title {
      font-size: 24px;
      font-weight: normal;
      margin-bottom: 5px;
    }

    .banner-subtitle {
      font-size: 16px;
      margin-bottom: 20px;
    }

    /* Send Money Form */
    .send-money-form {
      padding: 20px 15px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .form-input {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid var(--boa-border);
      border-radius: 5px;
      font-size: 16px;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--boa-dark-blue);
    }

    .input-with-icon {
      position: relative;
    }

    .input-with-icon i {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--boa-gray);
    }

    .input-with-icon input {
      padding-left: 40px;
    }

    .form-select {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid var(--boa-border);
      border-radius: 5px;
      font-size: 16px;
      background-color: var(--boa-white);
      appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23767676' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 15px center;
      background-size: 15px;
    }

    .form-select:focus {
      outline: none;
      border-color: var(--boa-dark-blue);
    }

    .form-button {
      width: 100%;
      padding: 15px;
      background-color: var(--boa-red);
      color: var(--boa-white);
      border: none;
      border-radius: 5px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 20px;
    }

    .form-button:disabled {
      background-color: var(--boa-gray);
      cursor: not-allowed;
    }

    /* Error Message */
    .error-message {
      background-color: #FFEBEE;
      color: var(--boa-red);
      padding: 15px;
      border-radius: 5px;
      margin-bottom: 20px;
      display: none;
    }

    /* Transaction Code Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background-color: var(--boa-white);
      border-radius: 10px;
      width: 90%;
      max-width: 400px;
      padding: 20px;
    }

    .modal-title {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 15px;
      text-align: center;
    }

    .modal-message {
      margin-bottom: 15px;
      text-align: center;
    }

    /* Bottom Navigation */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      max-width: 414px;
      margin: 0 auto;
      height: 60px;
      background-color: var(--boa-white);
      display: flex;
      justify-content: space-around;
      align-items: center;
      border-top: 1px solid var(--boa-border);
      z-index: 100;
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 8px 0;
      width: 25%;
      cursor: pointer;
    }

    .nav-item.active {
      color: var(--boa-red);
    }

    .nav-item i {
      font-size: 20px;
      margin-bottom: 4px;
    }

    .nav-text {
      font-size: 12px;
    }

    /* Content padding for bottom nav */
    .boa-content {
      padding-bottom: 80px;
    }
  </style>
</head>
<body>
  <div class="mobile-container">
    <!-- Header -->
    <header class="boa-header">
      <div class="logo">
        <div class="logo-text">BANK OF America</div>
        <div class="logo-icon">
          <i class="fas fa-flag"></i>
        </div>
      </div>
      <div class="profile-icon" id="profile-btn">
        <i class="fas fa-user"></i>
      </div>
    </header>

    <!-- Main Content -->
    <main class="boa-content">
      <!-- Send Money Banner -->
      <section class="send-money-banner">
        <div class="banner-title">Send Money</div>
        <div class="banner-subtitle">Send money to friends, family, or businesses</div>
      </section>

      <!-- Send Money Form -->
      <section class="send-money-form">
        <div class="error-message" id="error-message"></div>
        
        <div class="form-group">
          <label class="form-label">From</label>
          <select class="form-select" id="from-account">
            <option value="checking">Checking Account</option>
          </select>
        </div>
        
        <div class="form-group">
          <label class="form-label">To (Account Number)</label>
          <input type="text" class="form-input" id="recipient-account" placeholder="Enter recipient's account number" required>
        </div>
        
        <div class="form-group">
          <label class="form-label">Amount</label>
          <div class="input-with-icon">
            <i class="fas fa-dollar-sign"></i>
            <input type="number" class="form-input" id="amount" placeholder="0.00" step="0.01" min="0.01" required>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Note (Optional)</label>
          <input type="text" class="form-input" id="note" placeholder="What's this for?">
        </div>
        
        <button type="button" class="form-button" id="send-money-btn">Send Money</button>
      </section>
    </main>

    <!-- Transaction Code Modal -->
    <div class="modal" id="transaction-code-modal">
      <div class="modal-content">
        <div class="modal-title">Enter Transaction Code</div>
        <div class="modal-message">To complete this transaction, please enter the transaction code.</div>
        
        <div class="form-group">
          <input type="text" class="form-input" id="transaction-code" placeholder="Enter transaction code" required>
        </div>
        
        <div class="error-message" id="modal-error-message"></div>
        
        <button type="button" class="form-button" id="confirm-transaction-btn">Confirm Transaction</button>
      </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
      <div class="nav-item" id="nav-accounts">
        <i class="fas fa-credit-card"></i>
        <div class="nav-text">Accounts</div>
      </div>
      <div class="nav-item active" id="nav-pay">
        <i class="fas fa-exchange-alt"></i>
        <div class="nav-text">Pay & Transfer</div>
      </div>
      <div class="nav-item" id="nav-plan">
        <i class="fas fa-chart-line"></i>
        <div class="nav-text">Plan & Track</div>
      </div>
      <div class="nav-item" id="nav-investment">
        <i class="fas fa-chart-bar"></i>
        <div class="nav-text">Investment</div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // Check if user is logged in
      const isLoggedIn = localStorage.getItem("isLoggedIn") === "true";
      if (!isLoggedIn) {
        window.location.href = "login.html";
        return;
      }

      // Get user data from localStorage
      const userString = localStorage.getItem("user");
      let user = null;

      if (userString) {
        try {
          user = JSON.parse(userString);
          
          // Update from account select with balance
          const fromAccountSelect = document.getElementById("from-account");
          if (fromAccountSelect && user.balance !== undefined) {
            const formattedBalance = user.balance.toLocaleString(undefined, {
              minimumFractionDigits: 2,
              maximumFractionDigits: 2
            });
            fromAccountSelect.innerHTML = `<option value="checking">Checking Account - $${formattedBalance}</option>`;
          }
        } catch (e) {
          console.error("Error parsing user data:", e);
        }
      }

      // Handle profile button click
      const profileBtn = document.getElementById("profile-btn");
      if (profileBtn) {
        profileBtn.addEventListener("click", () => {
          window.location.href = "dashboard.html";
        });
      }

      // Handle send money button
      const sendMoneyBtn = document.getElementById("send-money-btn");
      const recipientAccountInput = document.getElementById("recipient-account");
      const amountInput = document.getElementById("amount");
      const noteInput = document.getElementById("note");
      const errorMessage = document.getElementById("error-message");
      const transactionCodeModal = document.getElementById("transaction-code-modal");
      
      if (sendMoneyBtn) {
        sendMoneyBtn.addEventListener("click", () => {
          // Validate inputs
          if (!recipientAccountInput.value) {
            errorMessage.textContent = "Please enter a recipient account number";
            errorMessage.style.display = "block";
            return;
          }

          if (!amountInput.value || Number(amountInput.value) <= 0) {
            errorMessage.textContent = "Please enter a valid amount";
            errorMessage.style.display = "block";
            return;
          }

          // Check if user has enough balance
          if (user && user.balance < Number(amountInput.value)) {
            errorMessage.textContent = "Insufficient funds";
            errorMessage.style.display = "block";
            return;
          }

          // Show transaction code modal
          if (transactionCodeModal) {
            transactionCodeModal.classList.add("active");
          }
        });
      }

      // Handle confirm transaction button
      const confirmTransactionBtn = document.getElementById("confirm-transaction-btn");
      const transactionCodeInput = document.getElementById("transaction-code");
      const modalErrorMessage = document.getElementById("modal-error-message");
      
      if (confirmTransactionBtn) {
        confirmTransactionBtn.addEventListener("click", () => {
          // Validate transaction code
          if (!transactionCodeInput.value) {
            modalErrorMessage.textContent = "Please enter the transaction code";
            modalErrorMessage.style.display = "block";
            return;
          }

          // Check if transaction code is correct
          if (transactionCodeInput.value !== "45242769012") {
            modalErrorMessage.textContent = "Invalid transaction code. Please try again.";
            modalErrorMessage.style.display = "block";
            return;
          }

          // Process the transaction
          const amount = Number(amountInput.value);
          const recipientAccount = recipientAccountInput.value;
          const note = noteInput.value;

          // Create transaction data
          const transaction = {
            senderAccountNumber: user.accountNumber,
            senderName: user.name,
            recipientAccountNumber: recipientAccount,
            recipientName: "Recipient", // This would be fetched from the server in a real app
            amount: amount,
            note: note,
            date: new Date().toISOString(),
            status: "completed"
          };

          // Update user balance
          user.balance -= amount;
          localStorage.setItem("user", JSON.stringify(user));

          // Save transaction to localStorage
          let transactions = [];
          const transactionsString = localStorage.getItem("transactions");
          
          if (transactionsString) {
            try {
              transactions = JSON.parse(transactionsString);
            } catch (e) {
              console.error("Error parsing transactions:", e);
            }
          }
          
          transactions.push(transaction);
          localStorage.setItem("transactions", JSON.stringify(transactions));
          
          // Save last transaction for receipt
          localStorage.setItem("lastTransaction", JSON.stringify(transaction));

          // Redirect to confirmation page
          window.location.href = "confirmation.html";
        });
      }

      // Handle bottom navigation
      const navAccounts = document.getElementById("nav-accounts");
      const navPay = document.getElementById("nav-pay");
      const navPlan = document.getElementById("nav-plan");
      const navInvestment = document.getElementById("nav-investment");
      
      if (navAccounts) {
        navAccounts.addEventListener("click", () => {
          window.location.href = "dashboard.html";
        });
      }
    });
  </script>
</body>
</html>